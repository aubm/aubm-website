<!doctype html>
<html>
<head>
    <base href="/">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="author" content="Aurélien Baumann (Aubm)">

<meta name="description" content="">

<title>Webservice Restful avec Symfony2 : gérer les champs de type Datetime</title>
<meta name="generator" content="Hugo 0.19-DEV" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.1.0/styles/pojoaque.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.1.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:400,700" rel="stylesheet" type="text/css">
<link  href="http://www.aubm.net/css/theme.min.css" rel="stylesheet" type="text/css">

</head>
<body>
<div class="page-container container-fluid">
<div class="col-md-3 menu">
    <nav class="col-md-3">
    <h3 class="home-link"><a href="/">Racine</a></h3>
    <div id="last-posts" class="open">
        <h3 data-open="last-posts">Aubm - Les derniers articles</h3>
        <ul>
            
            <li><a href="http://www.aubm.net/blog/pourquoi-big-o-est-important/">Pourquoi Big O est important ?</a></li>
            
            <li><a href="http://www.aubm.net/blog/comment-vous-faire-une-idee-d-l-impact-de-la-latence-de-votre-televiseur-dans-vos-sessions-de-jeux-videos/">Comment vous faire une idée de l&#39;impact de la latence de votre téléviseur dans vos sessions de jeux vidéos</a></li>
            
            <li><a href="http://www.aubm.net/blog/testing-d-une-app-golang-sur-appengine-une-maniere-de-gerer-l-erreur-newcontext-passed-an-unknown-http-request/">Testing d&#39;une app golang sur AppEngine : une manière de gérer l&#39;erreur NewContext passed an unknown http.Request</a></li>
            
            <li><a href="http://www.aubm.net/blog/l-injection-de-dependances-a-l-esprit-dans-vos-applications-golang/">L&#39;injection de dépendances à l&#39;esprit dans vos applications Golang</a></li>
            
            <li><a href="http://www.aubm.net/blog/aller-plus-loin-avec-postman/">Aller plus loin avec Postman</a></li>
            
            <li><a href="http://www.aubm.net/blog/du-neuf-sous-le-capot/">Du neuf sous le capot</a></li>
            
            <li><a href="http://www.aubm.net/blog/gardez-le-code-explicite-court-et-modulaire/">Gardez le code explicite, court et modulaire</a></li>
            
            <li><a href="http://www.aubm.net/blog/contrainte-dunicite-dans-symfony-2-avec-doctrine/">Contrainte d&#39;unicité dans Symfony 2 avec Doctrine</a></li>
            
            <li><a href="http://www.aubm.net/blog/mes-premiers-pas-avec-cakephp-3/">Mes premiers pas avec CakePHP 3</a></li>
            
            <li><a href="http://www.aubm.net/blog/installation-et-utilisation-de-sentry/">Installation et utilisation de Sentry</a></li>
            
        </ul>
    </div>

    
    <div id="tags" class="open">
        <h3 data-open="tags">Tags</h3>
        <ul class="tags">
            
            <li><a href="/tags/astuce">astuce</a></li>
            
            <li><a href="/tags/cakephp">cakephp</a></li>
            
            <li><a href="/tags/doctrine">doctrine</a></li>
            
            <li><a href="/tags/golang">golang</a></li>
            
            <li><a href="/tags/joomla">joomla</a></li>
            
            <li><a href="/tags/php">php</a></li>
            
            <li><a href="/tags/solution">solution</a></li>
            
            <li><a href="/tags/symfony">symfony</a></li>
            
        </ul>
    </div>
    

    
</nav>

</div>
<div class="col-md-9 content">

<h1>Webservice Restful avec Symfony2 : gérer les champs de type Datetime</h1>
<h4>Publié le 07-03-2014 19:24:23</h4>

<a href="https://twitter.com/share" class="twitter-share-button" data-via="kendo5731"></a>
<script>!function (d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0], p = /^http:/.test(d.location) ? 'http' : 'https';
    if (!d.getElementById(id)) {
        js = d.createElement(s);
        js.id = id;
        js.src = p + '://platform.twitter.com/widgets.js';
        fjs.parentNode.insertBefore(js, fjs);
    }
}(document, 'script', 'twitter-wjs');</script>

<div class="fb-share-button" data-href="http://www.aubm.net/blog/webservice-restful-avec-symfony2-gerer-les-champs-de-type-datetime/" data-layout="button"></div>
<div id="fb-root"></div>
<script>(function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/fr_FR/sdk.js#xfbml=1&version=v2.5";
    fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>

<article>
    <p>Si vous choisissez Symfony pour construire une application de webservice, il est un détail à relever à propos des champs de type Datetime dans le cas d&rsquo;utilisation des objets formulaires.</p>

<p>Prenons par exemple ce code qui génère un formulaire à partir des champs d&rsquo;une entité Post fictive :</p>

<pre><code class="language-php">$builder
    -&gt;add('title')
    -&gt;add('content')
    -&gt;add('published')
     ;
</code></pre>

<p>Dans cet exemple, le champ published est de type Datetime. Si on utilise ce formulaire pour générer du code HTML, Symfony générera pour le champ published le code suivant :</p>

<pre><code class="language-html">&lt;div&gt;
    &lt;label class=&quot;required&quot;&gt;Published&lt;/label&gt;
    &lt;div id=&quot;acme_demobundle_post_published&quot;&gt;
        &lt;div id=&quot;acme_demobundle_post_published_date&quot;&gt;
            &lt;select id=&quot;acme_demobundle_post_published_date_year&quot; name=&quot;acme_demobundle_post[published][date][year]&quot;&gt;
                &lt;option value=&quot;2009&quot;&gt;2009&lt;/option&gt;
                &lt;option value=&quot;2010&quot;&gt;2010&lt;/option&gt;
                ...
            &lt;/select&gt;
            &lt;select id=&quot;acme_demobundle_post_published_date_month&quot; name=&quot;acme_demobundle_post[published][date][month]&quot;&gt;
                &lt;option value=&quot;1&quot;&gt;Jan&lt;/option&gt;
                &lt;option value=&quot;2&quot;&gt;Feb&lt;/option&gt;
                ...
            &lt;/select&gt;
            &lt;select id=&quot;acme_demobundle_post_published_date_day&quot; name=&quot;acme_demobundle_post[published][date][day]&quot;&gt;
                &lt;option value=&quot;1&quot;&gt;1&lt;/option&gt;
                &lt;option value=&quot;2&quot;&gt;2&lt;/option&gt;
                ...
            &lt;/select&gt;
        &lt;/div&gt;
        &lt;div id=&quot;acme_demobundle_post_published_time&quot;&gt;
            &lt;select id=&quot;acme_demobundle_post_published_time_hour&quot; name=&quot;acme_demobundle_post[published][time][hour]&quot;&gt;
                &lt;option value=&quot;0&quot;&gt;00&lt;/option&gt;
                &lt;option value=&quot;1&quot;&gt;01&lt;/option&gt;
                &lt;option value=&quot;2&quot;&gt;02&lt;/option&gt;
                ...
            &lt;/select&gt;
            &lt;select id=&quot;acme_demobundle_post_published_time_minute&quot; name=&quot;acme_demobundle_post[published][time][minute]&quot;&gt;
                &lt;option value=&quot;0&quot;&gt;00&lt;/option&gt;
                &lt;option value=&quot;1&quot;&gt;01&lt;/option&gt;
                &lt;option value=&quot;2&quot;&gt;02&lt;/option&gt;
                ...
            &lt;/select&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;
</code></pre>

<p>A noter que la valeur du champs est construite dans un tableau rassemblant les différents informations year, month, day, etc &hellip;</p>

<p>Si on utilise ce formulaire pour mettre à jour les informations d&rsquo;un objet Post via une route <code>PUT /posts/{postId}</code> par exemple, le client devra construire la valeur de l&rsquo;attribut published de la même façon que dans ce formulaire. Soit quelque chose comme ça :</p>

<pre><code>published[date][year] = 2000
published[date][month] = 12
published[date][day] = 15
published[time][hour] = 12
published[time][minute] = 12
</code></pre>

<p>Voilà qui pourrait convenir, cependant pour une question de simplicité pour le client, nous souhaitons que celui-ci nous envoie l&rsquo;information published de cette façon :</p>

<pre><code>published = 2000-12-15
</code></pre>

<p>Pour ce faire, la solution est très simple, il suffit de changer la valeur par défaut de certaines options de l&rsquo;entrée published de la classe du formulaire.</p>

<p>Voici le code du formulaire, modifié de façon à ce qu&rsquo;il se comporte comme nous le souhaitons :</p>

<pre><code class="language-php">$builder
    -&gt;add('title')
    -&gt;add('content')
    -&gt;add('published', null, array(
        &quot;widget&quot; =&gt; &quot;single_text&quot;,
        &quot;format&quot; =&gt; &quot;yyyy-MM-dd&quot;,
     ))
     ;
</code></pre>

<p>Nous avons défini deux options. L&rsquo;option widget est définie à single_text de manière à ce que le formulaire attende la valeur du champ dans une seule variable. L&rsquo;option format quant à elle permet de définir le format qui est attendu pour la date.</p>

<p>N&rsquo;hésitez pas à consulter la <a href="http://symfony.com/fr/doc/current/reference/forms/types/date.html" target="_blank">documentation de Symfony</a> pour en savoir plus sur ces options ainsi que sur les autres options disponibles pour le type champ Date.</p>

</article>

<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'wwwaubmnet';
    var disqus_identifier = 'http:\/\/www.aubm.net\/blog\/webservice-restful-avec-symfony2-gerer-les-champs-de-type-datetime\/';
    var disqus_title = 'Webservice Restful avec Symfony2 : gérer les champs de type Datetime';
    var disqus_url = 'http:\/\/www.aubm.net\/blog\/webservice-restful-avec-symfony2-gerer-les-champs-de-type-datetime\/';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

</div>
</div>
<script src="js/theme.min.js" type="text/javascript"></script>

<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-38043974-6', 'auto');
ga('send', 'pageview');
</script>


</body>
</html>

